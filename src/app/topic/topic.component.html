<mat-toolbar color="primary" [ngClass]="'stage'+topic?.stage">
	<div class="flex container">
		<div class="topic-title">
			<h1>{{topic?.name}}</h1>
			<p *ngIf="topic?.stage != C.STAGE_REJECTED && topic?.stage != C.STAGE_PASSED">
				{{ topic?.stageName | translate }} {{ 'TOPIC_SUBTITLE_1' | translate }} {{ topic?.nextDeadline | date:'y-MM-dd' }} {{ 'TOPIC_SUBTITLE_2' | translate }} {{ topic?.nextDeadline | date:'HH:mm:ss' }} (<countdown [time]="topic?.nextDeadline"></countdown>)
			</p>
			<p *ngIf="topic?.stage == C.STAGE_PASSED">{{ topic?.stageName | translate }} {{ 'TOPIC_SUBTITLE_3' | translate }} {{ topic?.stagePassedStarted | date:'y-MM-dd' }}</p>
			<p *ngIf="topic?.stage == C.STAGE_REJECTED">{{ topic?.stageName | translate }}, {{ topic?.rejectedReason | translate }}</p>
		</div>
		<span class="flex-spacer"></span>
		<button mat-button *ngIf="topic?.stage == C.STAGE_SELECTION" title="{{ 'TOPIC_BUTTON_MARK_RELEVANT' | translate }}">
			<span><fa-icon [icon]="faHandPaper"></fa-icon> {{ 'TOPIC_BUTTON_MARK_RELEVANT' | translate }}</span>
		</button>
		<button mat-button *ngIf="topic?.stage == C.STAGE_SELECTION && topic?.owner == meUid" title="{{ 'TOPIC_BUTTON_EDIT' | translate }}" (click)="toggleDescriptionEdit()">
			<span *ngIf="!descriptionEdit"><fa-icon [icon]="faEdit"></fa-icon> {{ 'TOPIC_BUTTON_EDIT' | translate }}</span>
			<span *ngIf="descriptionEdit"><fa-icon [icon]="faSave"></fa-icon> {{ 'TOPIC_BUTTON_SAVE' | translate }}</span>
		</button>
		<button mat-button *ngIf="topic?.stage == C.STAGE_PROPOSAL && !topic?.ppid" title="{{ 'PROPOSAL_BUTTON_CREATE' | translate }}" (click)="createProposal()">
			<span><fa-icon [icon]="faFileMedical"></fa-icon> {{ 'PROPOSAL_BUTTON_CREATE' | translate }}</span>
		</button>
		<button mat-icon-button *ngIf="topic?.stage == C.STAGE_PASSED" title="{{ 'TOPIC_BUTTON_RESULT_DOWNLOAD' | translate }}"><fa-icon [icon]="faDownload"></fa-icon></button>
		<button mat-icon-button *ngIf="topic?.stage >= C.STAGE_CONSENSUS || topic?.stage == C.STAGE_REJECTED" title="{{ 'TOPIC_BUTTON_STRUCTURE' | translate }}"><fa-icon [icon]="faSitemap"></fa-icon></button>
		<button mat-icon-button (click)="enterFullscreen()" title="{{ 'GROUP_BUTTON_PRODUCTIVE_MODE' | translate }}"><fa-icon [icon]="faExpandArrowsAlt"></fa-icon></button>
		
		<button mat-icon-button [matMenuTriggerFor]="more">
			<fa-icon [icon]="faEllipsisV"></fa-icon>
		</button>
		<mat-menu #more="matMenu" [overlapTrigger]="false">
			<button mat-menu-item><fa-icon [icon]="faUser"></fa-icon> {{ 'TOPIC_BUTTON_AUTHOR' | translate }}</button>
			<button mat-menu-item><fa-icon [icon]="faShareSquare"></fa-icon> {{ 'TOPIC_BUTTON_SHARE' | translate }}</button>
		</mat-menu>
	</div>
</mat-toolbar>

<div class="container alert-box">
	<alert></alert>
</div>

<div class="container">
	<mat-tab-group>
		<mat-tab label="{{ 'TOPIC_TAB_LABEL_DESCRIPTION' | translate }}">
			<div *ngIf="!descriptionEdit" [innerHtml]="topic?.body"></div>
			<quill-editor *ngIf="descriptionEdit" [style]="{height: '300px'}" (onEditorCreated)="editorCreated($event, topic?.pid)" (onContentChanged)="contentChanged($event)"></quill-editor>
		</mat-tab>
		<!--<mat-tab label="Referenzen">Referenzen</mat-tab>-->
		<mat-tab label="{{ 'TOPIC_TAB_LABEL_PROPOSAL' | translate }}" *ngIf="topic?.stage == C.STAGE_PROPOSAL && topic?.ppid">
			<quill-editor *ngIf="topic?.stage == C.STAGE_PROPOSAL" [style]="{height: '300px'}" (onEditorCreated)="editorCreated($event, topic?.ppid)" (onContentChanged)="contentChanged($event)"></quill-editor>
		</mat-tab>
		<mat-tab label="{{ 'TOPIC_TAB_LABEL_GROUP' | translate }}" *ngIf="topic?.stage == C.STAGE_CONSENSUS">Meine Gruppe</mat-tab>
		<!--<mat-tab label="Statistik">Statistik</mat-tab>-->
		<mat-tab label="{{ 'TOPIC_TAB_LABEL_RESULT' | translate }}" *ngIf="topic?.stage == C.STAGE_PASSED"><div [innerHtml]="topic?.finalDocument"></div></mat-tab>
	</mat-tab-group>
</div>
